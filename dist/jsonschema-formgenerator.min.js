!function(e,t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):e.JsonschemaFormgenerator=t(e.jQuery)}(this,function(e){function t(e,t,n){return o(e,t,n).then(function(e){return f(),e})}function n(e){return $.when.apply($,e).then(function(){return $.makeArray(arguments).join("")})}function i(e,t,r){var s=e.pop(),l=s;isNaN(parseInt(s,10))||(l=e[e.length-1].slice(0,-1));var c=(e.length?e.join("-")+"-":"")+s,h=['<div class="schema-property schema-property-'+l+" schema-datatype-"+t.type+'" data-datatype="'+t.type+'">'],f=e.slice(0),m="root"+(e.length?"["+e.join("][")+"]":"")+"["+s+"]";if(f.push(s),void 0===r&&void 0!==t["default"]&&(r=t["default"]),t.options&&t.options.renderer&&v(t.options.renderer))return h.push(y(t.options.renderer,t,f,c,m,r)),h.push("</div>"),n(h);switch(t.type){case void 0:case"object":h.push(o(t,f,r));break;case"number":case"integer":t.options&&"hidden"===t.options.inputRenderer||h.push(d(c,t.title?t.title:s)),h.push(u(t,f,c,m,r));break;case"boolean":h.push(a(t,f,c,m,r));break;case"array":t.items["enum"]?(t.items.title=t.title,h.push(i(f,t.items,r).then(function(e){var t=$(e);return t.find("select").prop("multiple","multiple").each(function(){var e=$(this);e.attr("name",e.attr("name")+"[]").find("option").each(function(){var e=$(this);r&&-1!==r.indexOf(e.val())&&e.attr("selected","selected")})}),t.html()}))):(h.push("<fieldset>"),t.title&&h.push('<div class="legend">'+t.title+"</div>"),$.each(r||{},function(e,n){var r=f.slice(0);r.push(e),h.push(i(r,t.items,n))}),h.push("</fieldset>"));break;case"string":t.isEnum=void 0!==t["enum"],t.isHidden=t.options&&"hidden"===t.options.inputRenderer,(t.isEnum&&!t.isHidden||!t.isHidden)&&h.push(d(c,t.title?t.title:s,!t.isEnum&&t.minLength)),h.push(p(t,f,c,m,r));break;default:throw new Error('Schema item "'+e.join(".")+'" is not valid')}return h.push("</div>"),n(h)}function r(e,t,i){var r=[],s=[],a=t.pop(),u="root"+(t.length?"["+t.join("][")+"]":"")+"["+a+"]",p=(t.length?t.join("-")+"-":"")+a;return r.push('<label for="'+p+'">'+e.title+"</label>"),r.push('<select id="'+p+'" name="'+u+'" class="schema-property-oneOf-selector">'),$.each(e.oneOf,function(e,n){r.push('<option value="'+e+'">'+n.title+"</option>"),delete n.title,n.disabled=!0,console.log("oneOF adata",i),s.push(o(n,t,i))}),r.push("</select>"),r.push("</div>"),r.push('<div class="schema-property schema-property-'+a+' schema-property-oneOf" style="display:none">'),r.push(n(s)),r.push("</div>"),h(function(){$(document).on("change",".schema-property-oneOf-selector",function(){var e=$(event.target);e.closest(".schema-property").siblings(".schema-property-oneOf").show().find("> fieldset").attr("disabled","disabled").hide().each(function(t){t===parseInt(e.val(),10)&&$(this).removeAttr("disabled").show()})})}),n(r)}function s(e,t,i){var r=[];return $.each(e.allOf,function(e,n){r.push(o(n,t,i))}),n(chunks)}function o(e,t,o){var a=[];return o=o||{},void 0===e.properties?e.allOf?(a.push("<fieldset>"),a.push(s(e,t,o)),a.push("</fieldset>"),n(a)):e.oneOf?(a.push("<fieldset>"),a.push(r(e,t,o)),a.push("</fieldset>"),n(a)):n(a):(a.push("<fieldset"+(e.disabled?' disabled="disabled"':"")+">"),e.title&&a.push('<div class="legend">'+e.title+"</div>"),$.each(e.properties,function(e,n){t.slice(0),t.push(e),a.push(i(t,n,o[e]))}),a.push("</fieldset>"),n(a).then(function(t){if(e.required){var n=$("<p>").html(t);return $.each(e.required,function(e,t){n.find(["input","textarea","select"].map(function(e){return".schema-property-"+t+" > "+e}).join(",")).attr("required","required")}),n.html()}return t}))}function a(e,t,n,i,r){return'<input type="checkbox" name="'+i+'" id="'+n+'" value="1"'+(r?' checked="checked"':"")+' /><label for="'+n+'">'+e.title+"</label>"}function u(e,t,n,i,r){return"undefined"!=typeof e["enum"]?l(e,t,n,i,r):(e.format="number",c(e,t,n,i,r))}function p(e,t,n,i,r){return e.isEnum&&!e.isHidden?l(e,t,n,i,r):c(e,t,n,i,r)}function l(e,t,n,i,r){var s=[];void 0===r&&void 0!==e["default"]&&(r=e["default"]);var o=e.options&&e.options.enum_titles?e.options.enum_titles:{},a=e.options&&e.options.inputRenderer?e.options.inputRenderer:null;if(b(a))return x(a,e,t,n,i,r);var u=e.options&&e.options.multiple===!0,p=e.options&&e.options.readOnly===!0,l=e.options&&e.options.inputClasses?e.options.inputClasses.join(" "):!1,d=e.options&&e.options.rules?e.options.rules:!1;switch(e.inputType){case"radio":s.push('<div class="radiogroup">'),$.each(e["enum"],function(e,t){var a=n+"-"+t;s.push("<div>"),s.push('<input type="radio" name="'+i+'" value="'+t+'" id="'+a+'"'+(t===r?' checked="checked"':"")+'><label for="'+a+'">'+(o[e]||t)+"</label>"),s.push("</div>")}),s.push("</div>");break;default:s.push('<select name="'+i+'" id="'+n+'"'+(l?' class="'+l+'"':"")+(p?' readonly="readonly"':"")+(u?' multiple="multiple"':"")+(d?" data-rules='"+JSON.stringify(d)+"'":"")+">"),$.each(e["enum"],function(e,t){s.push('<option value="'+t+'"'+(t===r?' selected="selected"':"")+">"+(o[e]||t)+"</option>")}),s.push("</select>")}return s.join("")}function d(e,t,n){return'<label for="'+e+'">'+t+(n?" *":"")+"</label>"}function c(e,t,n,i,r){var s=e.format||"text";if(e.options&&e.options.inputRenderer&&(s=e.options.inputRenderer),b(s))return x(s,e,t,n,i,r);var o=e.description,a=e.options&&1==e.options.readOnly,u=e.options&&e.options.inputClasses?e.options.inputClasses.join(" "):!1,p=e.options&&e.options.rules?e.options.rules:!1;return"textarea"===s?'<textarea type="text"'+(u?' class="'+u+'"':"")+(n?' id="'+n+'"':"")+(i?' name="'+i+'"':"")+(e.minLength?' minlength="'+e.minLength+'"':"")+(e.maxLength?' maxlength="'+e.maxLength+'"':"")+(o?' placeholder="'+o+'"':"")+(a?' readonly="true"':"")+(p?" data-rules='"+JSON.stringify(p)+"'":"")+">"+(r||"")+"</textarea>":"<input "+(s?' type="'+s+'"':"")+(u?' class="'+u+'"':"")+(n?' id="'+n+'"':"")+(i?' name="'+i+'"':"")+(e.pattern?' pattern="'+e.pattern+'"':"")+(e.minLength?' minlength="'+e.minLength+'"':"")+(e.maxLength?' maxlength="'+e.maxLength+'"':"")+(e.min?' min="'+e.min+'"':"")+(e.max?' max="'+e.max+'"':"")+(r?' value="'+r+'"':"")+(e.title?' title="'+e.title+'"':"")+(o?' placeholder="'+o+'"':"")+(a?' readonly="true"':"")+(p?" data-rules='"+JSON.stringify(p)+"'":"")+"/>"}function h(e){j.push(e)}function f(){j.forEach(function(e){e()})}function m(e,t){O[e]=t}function v(e){return"undefined"!=typeof O[e]}function y(){var e=[].shift.call(arguments);return O[e]?O[e].apply(this,arguments):""}function g(e,t){k[e]=t}function b(e){return"undefined"!=typeof k[e]}function x(){var e=[].shift.call(arguments);return k[e]?k[e].apply(this,arguments):""}var j=[],O={},k={};return $.fn.appendSchema=function(e,t){var n=$(this);return o(e,[],t||{}).then(function(e){return n.append(e)})},{render:t,renderChunk:i,addRenderer:m,addInputRenderer:g}});
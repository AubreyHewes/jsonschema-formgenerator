!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):window.JSONSchemaFormRenderer=e(jQuery)}(function(e){function t(t){return e.when.apply(e,t).then(function(){return e.makeArray(arguments).join("")})}function n(a,p,l){var h=a.pop(),f=h;isNaN(parseInt(h,10))||(f=a[a.length-1].slice(0,-1));var m=(a.length?a.join("-")+"-":"")+h,v=['<div class="schema-property schema-property-'+f+" schema-datatype-"+p.type+'" data-datatype="'+p.type+'">'],y=a.slice(0),g="root"+(a.length?"["+a.join("][")+"]":"")+"["+h+"]";if(y.push(h),void 0===l&&void 0!==p["default"]&&(l=p["default"]),p.options&&p.options.renderer&&d(p.options.renderer))return v.push(c(p.options.renderer,p,y,m,g,l)),v.push("</div>"),t(v);switch(p.type){case void 0:case"object":v.push('<div class="fieldset">'),p.title&&v.push('<div class="legend">'+p.title+"</div>"),v.push(i(p,y,l)),v.push("</div>");break;case"number":case"integer":p.options&&"hidden"===p.options.inputRenderer||v.push(u(m,p.title?p.title:h)),v.push(o(p,y,m,g,l));break;case"boolean":v.push(r(p,y,m,g,l));break;case"array":p.items["enum"]?(p.items.title=p.title,v.push(n(y,p.items,l).then(function(t){var n=e(t);return n.find("select").prop("multiple","multiple").each(function(){var t=e(this);t.attr("name",t.attr("name")+"[]").find("option").each(function(){var t=e(this);l&&-1!==l.indexOf(t.val())&&t.attr("selected","selected")})}),n.html()}))):(v.push('<div class="fieldset">'),p.title&&v.push('<div class="legend">'+p.title+"</div>"),e.each(l||{},function(e,t){var i=y.slice(0);i.push(e),v.push(n(i,p.items,t))}),v.push("</div>"));break;case"string":var x=void 0!==p["enum"];(x||!p.options||"hidden"!==p.options.inputRenderer)&&v.push(u(m,p.title?p.title:h,!x&&p.minLength)),v.push(s(p,y,m,g,l));break;default:throw new Error('Schema item "'+a.join(".")+'" is not valid')}return v.push("</div>"),t(v)}function i(r,o,s){var a=[];return s=s||{},void 0===r.properties?r.allOf?(e.each(r.allOf,function(e,t){a.push(i(t,o,s))}),t(a)):r.oneOf?(e.each(r.oneOf,function(e,t){a.push(i(t,o,s))}),t(a)):t(a):(e.each(r.properties,function(e,t){o.slice(0),o.push(e),a.push(n(o,t,s[e]))}),t(a).then(function(t){if(r.required){var n=e("<p>").html(t);return e.each(r.required,function(e,t){n.find(["input","textarea","select"].map(function(e){return".schema-property-"+t+" > "+e}).join(",")).attr("required","required")}),n.html()}return t}))}function r(e,t,n,i,r){return'<input type="checkbox" name="'+i+'" id="'+n+'" value="1"'+(r?' checked="checked"':"")+' /><label for="'+n+'">'+e.title+"</label>"}function o(e,t,n,i,r){return"undefined"!=typeof e["enum"]?a(e,t,n,i,r):(e.format="number",p(e,t,n,i,r))}function s(e,t,n,i,r){return"undefined"!=typeof e["enum"]?a(e,t,n,i,r):p(e,t,n,i,r)}function a(t,n,i,r,o){var s=[];void 0===o&&void 0!==t["default"]&&(o=t["default"]);var a=t.options&&t.options.enum_titles?t.options.enum_titles:{},u=t.options&&t.options.inputRenderer?t.options.inputRenderer:null;if(f(u))return m(u,t,n,i,r,o);var p=t.options&&t.options.multiple===!0,l=t.options&&t.options.readOnly===!0,d=t.options&&t.options.inputClasses?t.options.inputClasses.join(" "):!1,c=t.options&&t.options.rules?t.options.rules:!1;switch(t.inputType){case"radio":s.push('<div class="radiogroup">'),e.each(t["enum"],function(e,t){var n=i+"-"+t;s.push("<div>"),s.push('<input type="radio" name="'+r+'" value="'+t+'" id="'+n+'"'+(t===o?' checked="checked"':"")+'><label for="'+n+'">'+(a[e]||t)+"</label>"),s.push("</div>")}),s.push("</div>");break;default:s.push('<select name="'+r+'" id="'+i+'"'+(d?' class="'+d+'"':"")+(l?' readonly="readonly"':"")+(p?' multiple="multiple"':"")+(c?" data-rules='"+JSON.stringify(c)+"'":"")+">"),e.each(t["enum"],function(e,t){s.push('<option value="'+t+'"'+(t===o?' selected="selected"':"")+">"+(a[e]||t)+"</option>")}),s.push("</select>")}return s.join("")}function u(e,t,n){return'<label for="'+e+'">'+t+(n?" *":"")+"</label>"}function p(e,t,n,i,r){var o=e.format||"text";if(e.options&&e.options.inputRenderer&&(o=e.options.inputRenderer),f(o))return m(o,e,t,n,i,r);var s=e.description,a=e.options&&1==e.options.readOnly,u=e.options&&e.options.inputClasses?e.options.inputClasses.join(" "):!1,p=e.options&&e.options.rules?e.options.rules:!1;return"textarea"===o?'<textarea type="text"'+(u?' class="'+u+'"':"")+(n?' id="'+n+'"':"")+(i?' name="'+i+'"':"")+(e.minLength?' minlength="'+e.minLength+'"':"")+(e.maxLength?' maxlength="'+e.maxLength+'"':"")+(s?' placeholder="'+s+'"':"")+(a?' readonly="true"':"")+(p?" data-rules='"+JSON.stringify(p)+"'":"")+">"+(r||"")+"</textarea>":"<input "+(o?' type="'+o+'"':"")+(u?' class="'+u+'"':"")+(n?' id="'+n+'"':"")+(i?' name="'+i+'"':"")+(e.pattern?' pattern="'+e.pattern+'"':"")+(e.minLength?' minlength="'+e.minLength+'"':"")+(e.maxLength?' maxlength="'+e.maxLength+'"':"")+(e.min?' min="'+e.min+'"':"")+(e.max?' max="'+e.max+'"':"")+(r?' value="'+r+'"':"")+(s?' placeholder="'+s+'"':"")+(a?' readonly="true"':"")+(p?" data-rules='"+JSON.stringify(p)+"'":"")+"/>"}function l(e,t){v[e]=t}function d(e){return"undefined"!=typeof v[e]}function c(){var e=[].shift.call(arguments);return v[e]?v[e].apply(this,arguments):""}function h(e,t){y[e]=t}function f(e){return"undefined"!=typeof y[e]}function m(){var e=[].shift.call(arguments);return y[e]?y[e].apply(this,arguments):""}var v={},y={};return e.fn.appendSchema=function(t,n){i(t,[],n).then(function(t){e(this).append(t)})},{render:i,renderChunk:n,addRenderer:l,addInputRenderer:h}});
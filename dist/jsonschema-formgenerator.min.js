!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):window.JSONSchemaFormRenderer=e(jQuery)}(function(e){function t(e,t,n){return o(e,t,n).then(function(e){return f(),e})}function n(t){return e.when.apply(e,t).then(function(){return e.makeArray(arguments).join("")})}function i(t,r,s){var l=t.pop(),c=l;isNaN(parseInt(l,10))||(c=t[t.length-1].slice(0,-1));var h=(t.length?t.join("-")+"-":"")+l,f=['<div class="schema-property schema-property-'+c+" schema-datatype-"+r.type+'" data-datatype="'+r.type+'">'],m=t.slice(0),g="root"+(t.length?"["+t.join("][")+"]":"")+"["+l+"]";if(m.push(l),void 0===s&&void 0!==r["default"]&&(s=r["default"]),r.options&&r.options.renderer&&v(r.options.renderer))return f.push(y(r.options.renderer,r,m,h,g,s)),f.push("</div>"),n(f);switch(r.type){case void 0:case"object":f.push(o(r,m,s));break;case"number":case"integer":r.options&&"hidden"===r.options.inputRenderer||f.push(d(h,r.title?r.title:l)),f.push(a(r,m,h,g,s));break;case"boolean":f.push(u(r,m,h,g,s));break;case"array":r.items["enum"]?(r.items.title=r.title,f.push(i(m,r.items,s).then(function(t){var n=e(t);return n.find("select").prop("multiple","multiple").each(function(){var t=e(this);t.attr("name",t.attr("name")+"[]").find("option").each(function(){var t=e(this);s&&-1!==s.indexOf(t.val())&&t.attr("selected","selected")})}),n.html()}))):(f.push('<div class="fieldset">'),r.title&&f.push('<div class="legend">'+r.title+"</div>"),e.each(s||{},function(e,t){var n=m.slice(0);n.push(e),f.push(i(n,r.items,t))}),f.push("</div>"));break;case"string":var b=void 0!==r["enum"];(b||!r.options||"hidden"!==r.options.inputRenderer)&&f.push(d(h,r.title?r.title:l,!b&&r.minLength)),f.push(p(r,m,h,g,s));break;default:throw new Error('Schema item "'+t.join(".")+'" is not valid')}return f.push("</div>"),n(f)}function r(t,i,r){var s=[],u=[],a=i.pop(),p=(i.length?i.join("-")+"-":"")+a;return s.push('<label for="'+p+'">'+t.title+"</label>"),s.push('<select id="'+p+'" class="schema-property-oneOf-selector">'),e.each(t.oneOf,function(e,t){s.push('<option value="'+e+'">'+t.title+"</option>"),delete t.title,u.push(o(t,i,r))}),s.push("</select>"),s.push("</div>"),s.push('<div class="schema-property schema-property-oneOf" style="display:none">'),s.push(n(u)),s.push("</div>"),h(function(){e(document).on("change",".schema-property-oneOf-selector",function(){var t=e(event.target);t.closest(".fieldset").siblings(".schema-property-oneOf").show().find("> .fieldset").hide().each(function(n){n===parseInt(t.val(),10)&&e(this).show()})})}),n(s)}function s(t,i,r){return e.each(t.allOf,function(e,t){chunkPromises.push(o(t,i,r))}),n(chunks)}function o(t,o,u){var a=[];return u=u||{},void 0===t.properties?t.allOf?(a.push('<div class="fieldset">'),a.push(s(t,o,u)),a.push("</div>"),n(a)):t.oneOf?(a.push('<div class="fieldset">'),a.push(r(t,o,u)),a.push("</div>"),n(a)):n(a):(a.push('<div class="fieldset">'),t.title&&a.push('<div class="legend">'+t.title+"</div>"),e.each(t.properties,function(e,t){o.slice(0),o.push(e),a.push(i(o,t,u[e]))}),a.push("</div>"),n(a).then(function(n){if(t.required){var i=e("<p>").html(n);return e.each(t.required,function(e,t){i.find(["input","textarea","select"].map(function(e){return".schema-property-"+t+" > "+e}).join(",")).attr("required","required")}),i.html()}return n}))}function u(e,t,n,i,r){return'<input type="checkbox" name="'+i+'" id="'+n+'" value="1"'+(r?' checked="checked"':"")+' /><label for="'+n+'">'+e.title+"</label>"}function a(e,t,n,i,r){return"undefined"!=typeof e["enum"]?l(e,t,n,i,r):(e.format="number",c(e,t,n,i,r))}function p(e,t,n,i,r){return"undefined"!=typeof e["enum"]?l(e,t,n,i,r):c(e,t,n,i,r)}function l(t,n,i,r,s){var o=[];void 0===s&&void 0!==t["default"]&&(s=t["default"]);var u=t.options&&t.options.enum_titles?t.options.enum_titles:{},a=t.options&&t.options.inputRenderer?t.options.inputRenderer:null;if(b(a))return x(a,t,n,i,r,s);var p=t.options&&t.options.multiple===!0,l=t.options&&t.options.readOnly===!0,d=t.options&&t.options.inputClasses?t.options.inputClasses.join(" "):!1,c=t.options&&t.options.rules?t.options.rules:!1;switch(t.inputType){case"radio":o.push('<div class="radiogroup">'),e.each(t["enum"],function(e,t){var n=i+"-"+t;o.push("<div>"),o.push('<input type="radio" name="'+r+'" value="'+t+'" id="'+n+'"'+(t===s?' checked="checked"':"")+'><label for="'+n+'">'+(u[e]||t)+"</label>"),o.push("</div>")}),o.push("</div>");break;default:o.push('<select name="'+r+'" id="'+i+'"'+(d?' class="'+d+'"':"")+(l?' readonly="readonly"':"")+(p?' multiple="multiple"':"")+(c?" data-rules='"+JSON.stringify(c)+"'":"")+">"),e.each(t["enum"],function(e,t){o.push('<option value="'+t+'"'+(t===s?' selected="selected"':"")+">"+(u[e]||t)+"</option>")}),o.push("</select>")}return o.join("")}function d(e,t,n){return'<label for="'+e+'">'+t+(n?" *":"")+"</label>"}function c(e,t,n,i,r){var s=e.format||"text";if(e.options&&e.options.inputRenderer&&(s=e.options.inputRenderer),b(s))return x(s,e,t,n,i,r);var o=e.description,u=e.options&&1==e.options.readOnly,a=e.options&&e.options.inputClasses?e.options.inputClasses.join(" "):!1,p=e.options&&e.options.rules?e.options.rules:!1;return"textarea"===s?'<textarea type="text"'+(a?' class="'+a+'"':"")+(n?' id="'+n+'"':"")+(i?' name="'+i+'"':"")+(e.minLength?' minlength="'+e.minLength+'"':"")+(e.maxLength?' maxlength="'+e.maxLength+'"':"")+(o?' placeholder="'+o+'"':"")+(u?' readonly="true"':"")+(p?" data-rules='"+JSON.stringify(p)+"'":"")+">"+(r||"")+"</textarea>":"<input "+(s?' type="'+s+'"':"")+(a?' class="'+a+'"':"")+(n?' id="'+n+'"':"")+(i?' name="'+i+'"':"")+(e.pattern?' pattern="'+e.pattern+'"':"")+(e.minLength?' minlength="'+e.minLength+'"':"")+(e.maxLength?' maxlength="'+e.maxLength+'"':"")+(e.min?' min="'+e.min+'"':"")+(e.max?' max="'+e.max+'"':"")+(r?' value="'+r+'"':"")+(o?' placeholder="'+o+'"':"")+(u?' readonly="true"':"")+(p?" data-rules='"+JSON.stringify(p)+"'":"")+"/>"}function h(e){k.push(e)}function f(){k.forEach(function(e){e()})}function m(e,t){O[e]=t}function v(e){return"undefined"!=typeof O[e]}function y(){var e=[].shift.call(arguments);return O[e]?O[e].apply(this,arguments):""}function g(e,t){j[e]=t}function b(e){return"undefined"!=typeof j[e]}function x(){var e=[].shift.call(arguments);return j[e]?j[e].apply(this,arguments):""}var k=[],O={},j={};return e.fn.appendSchema=function(t,n){var i=e(this);return o(t,[],n||{}).then(function(e){return i.append(e)})},{render:t,renderChunk:i,addRenderer:m,addInputRenderer:g}});
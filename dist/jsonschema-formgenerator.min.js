!function(e,t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):e.JsonschemaFormgenerator=t(e.jQuery)}(this,function(e){function t(e,t,n){return o(e,t,n).then(function(e){return f(),e})}function n(e){return $.when.apply($,e).then(function(){return $.makeArray(arguments).join("")})}function i(e,t,s){var r=e.pop(),l=r;isNaN(parseInt(r,10))||(l=e[e.length-1].slice(0,-1));var c=(e.length?e.join("-")+"-":"")+r,h=['<div class="schema-property schema-property-'+l+" schema-datatype-"+t.type+'" data-datatype="'+t.type+'">'],f=e.slice(0),m="root"+(e.length?"["+e.join("][")+"]":"")+"["+r+"]";if(f.push(r),void 0===s&&void 0!==t["default"]&&(s=t["default"]),t.options&&t.options.renderer&&v(t.options.renderer))return h.push(y(t.options.renderer,t,f,c,m,s)),h.push("</div>"),n(h);switch(t.type){case void 0:case"object":h.push(o(t,f,s));break;case"number":case"integer":t.options&&"hidden"===t.options.inputRenderer||h.push(d(c,t.title?t.title:r)),h.push(a(t,f,c,m,s));break;case"boolean":h.push(u(t,f,c,m,s));break;case"array":t.items["enum"]?(t.items.title=t.title,h.push(i(f,t.items,s).then(function(e){var t=$(e);return t.find("select").prop("multiple","multiple").each(function(){var e=$(this);e.attr("name",e.attr("name")+"[]").find("option").each(function(){var e=$(this);s&&-1!==s.indexOf(e.val())&&e.attr("selected","selected")})}),t.html()}))):(h.push('<div class="fieldset">'),t.title&&h.push('<div class="legend">'+t.title+"</div>"),$.each(s||{},function(e,n){var s=f.slice(0);s.push(e),h.push(i(s,t.items,n))}),h.push("</div>"));break;case"string":t.isEnum=void 0!==t["enum"],t.isHidden=t.options&&"hidden"===t.options.inputRenderer,(t.isEnum&&!t.isHidden||!t.isHidden)&&h.push(d(c,t.title?t.title:r,!t.isEnum&&t.minLength)),h.push(p(t,f,c,m,s));break;default:throw new Error('Schema item "'+e.join(".")+'" is not valid')}return h.push("</div>"),n(h)}function s(e,t,i){var s=[],r=[],u=t.pop(),a=(t.length?t.join("-")+"-":"")+u;return s.push('<label for="'+a+'">'+e.title+"</label>"),s.push('<select id="'+a+'" class="schema-property-oneOf-selector">'),$.each(e.oneOf,function(e,n){s.push('<option value="'+e+'">'+n.title+"</option>"),delete n.title,r.push(o(n,t,i))}),s.push("</select>"),s.push("</div>"),s.push('<div class="schema-property schema-property-oneOf" style="display:none">'),s.push(n(r)),s.push("</div>"),h(function(){$(document).on("change",".schema-property-oneOf-selector",function(){var e=$(event.target);e.closest(".fieldset").siblings(".schema-property-oneOf").show().find("> .fieldset").hide().each(function(t){t===parseInt(e.val(),10)&&$(this).show()})})}),n(s)}function r(e,t,i){return $.each(e.allOf,function(e,n){chunkPromises.push(o(n,t,i))}),n(chunks)}function o(e,t,o){var u=[];return o=o||{},void 0===e.properties?e.allOf?(u.push('<div class="fieldset">'),u.push(r(e,t,o)),u.push("</div>"),n(u)):e.oneOf?(u.push('<div class="fieldset">'),u.push(s(e,t,o)),u.push("</div>"),n(u)):n(u):(u.push('<div class="fieldset">'),e.title&&u.push('<div class="legend">'+e.title+"</div>"),$.each(e.properties,function(e,n){t.slice(0),t.push(e),u.push(i(t,n,o[e]))}),u.push("</div>"),n(u).then(function(t){if(e.required){var n=$("<p>").html(t);return $.each(e.required,function(e,t){n.find(["input","textarea","select"].map(function(e){return".schema-property-"+t+" > "+e}).join(",")).attr("required","required")}),n.html()}return t}))}function u(e,t,n,i,s){return'<input type="checkbox" name="'+i+'" id="'+n+'" value="1"'+(s?' checked="checked"':"")+' /><label for="'+n+'">'+e.title+"</label>"}function a(e,t,n,i,s){return"undefined"!=typeof e["enum"]?l(e,t,n,i,s):(e.format="number",c(e,t,n,i,s))}function p(e,t,n,i,s){return e.isEnum&&!e.isHidden?l(e,t,n,i,s):c(e,t,n,i,s)}function l(e,t,n,i,s){var r=[];void 0===s&&void 0!==e["default"]&&(s=e["default"]);var o=e.options&&e.options.enum_titles?e.options.enum_titles:{},u=e.options&&e.options.inputRenderer?e.options.inputRenderer:null;if(b(u))return x(u,e,t,n,i,s);var a=e.options&&e.options.multiple===!0,p=e.options&&e.options.readOnly===!0,l=e.options&&e.options.inputClasses?e.options.inputClasses.join(" "):!1,d=e.options&&e.options.rules?e.options.rules:!1;switch(e.inputType){case"radio":r.push('<div class="radiogroup">'),$.each(e["enum"],function(e,t){var u=n+"-"+t;r.push("<div>"),r.push('<input type="radio" name="'+i+'" value="'+t+'" id="'+u+'"'+(t===s?' checked="checked"':"")+'><label for="'+u+'">'+(o[e]||t)+"</label>"),r.push("</div>")}),r.push("</div>");break;default:r.push('<select name="'+i+'" id="'+n+'"'+(l?' class="'+l+'"':"")+(p?' readonly="readonly"':"")+(a?' multiple="multiple"':"")+(d?" data-rules='"+JSON.stringify(d)+"'":"")+">"),$.each(e["enum"],function(e,t){r.push('<option value="'+t+'"'+(t===s?' selected="selected"':"")+">"+(o[e]||t)+"</option>")}),r.push("</select>")}return r.join("")}function d(e,t,n){return'<label for="'+e+'">'+t+(n?" *":"")+"</label>"}function c(e,t,n,i,s){var r=e.format||"text";if(e.options&&e.options.inputRenderer&&(r=e.options.inputRenderer),b(r))return x(r,e,t,n,i,s);var o=e.description,u=e.options&&1==e.options.readOnly,a=e.options&&e.options.inputClasses?e.options.inputClasses.join(" "):!1,p=e.options&&e.options.rules?e.options.rules:!1;return"textarea"===r?'<textarea type="text"'+(a?' class="'+a+'"':"")+(n?' id="'+n+'"':"")+(i?' name="'+i+'"':"")+(e.minLength?' minlength="'+e.minLength+'"':"")+(e.maxLength?' maxlength="'+e.maxLength+'"':"")+(o?' placeholder="'+o+'"':"")+(u?' readonly="true"':"")+(p?" data-rules='"+JSON.stringify(p)+"'":"")+">"+(s||"")+"</textarea>":"<input "+(r?' type="'+r+'"':"")+(a?' class="'+a+'"':"")+(n?' id="'+n+'"':"")+(i?' name="'+i+'"':"")+(e.pattern?' pattern="'+e.pattern+'"':"")+(e.minLength?' minlength="'+e.minLength+'"':"")+(e.maxLength?' maxlength="'+e.maxLength+'"':"")+(e.min?' min="'+e.min+'"':"")+(e.max?' max="'+e.max+'"':"")+(s?' value="'+s+'"':"")+(e.title?' title="'+e.title+'"':"")+(o?' placeholder="'+o+'"':"")+(u?' readonly="true"':"")+(p?" data-rules='"+JSON.stringify(p)+"'":"")+"/>"}function h(e){k.push(e)}function f(){k.forEach(function(e){e()})}function m(e,t){j[e]=t}function v(e){return"undefined"!=typeof j[e]}function y(){var e=[].shift.call(arguments);return j[e]?j[e].apply(this,arguments):""}function g(e,t){O[e]=t}function b(e){return"undefined"!=typeof O[e]}function x(){var e=[].shift.call(arguments);return O[e]?O[e].apply(this,arguments):""}var k=[],j={},O={};return $.fn.appendSchema=function(e,t){var n=$(this);return o(e,[],t||{}).then(function(e){return n.append(e)})},{render:t,renderChunk:i,addRenderer:m,addInputRenderer:g}});
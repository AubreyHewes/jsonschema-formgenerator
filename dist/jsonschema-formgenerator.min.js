!function(e,t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):e.JsonschemaFormgenerator=t(e.jQuery)}(this,function(e){function t(e,t,n){return o(e,t,n).then(function(e){return m(),e})}function n(e){return $.when.apply($,e).then(function(){return $.makeArray(arguments).join("")})}function i(e,t,i){var r=e.pop(),s=r;isNaN(parseInt(r,10))||(s=e[e.length-1].slice(0,-1));var d=(e.length?e.join("-")+"-":"")+r,f=['<div class="schema-property schema-property-'+s+" schema-datatype-"+t.type+'" data-datatype="'+t.type+'">'],m=e.slice(0),v="root"+(e.length?"["+e.join("][")+"]":"")+"["+r+"]";if(m.push(r),void 0===i&&void 0!==t["default"]&&(i=t["default"]),t.options&&t.options.renderer&&y(t.options.renderer))return f.push(g(t.options.renderer,t,m,d,v,i)),f.push("</div>"),n(f);switch(t.type){case void 0:case"object":f.push(o(t,m,i));break;case"number":case"integer":t.options&&"hidden"===t.options.inputRenderer||f.push(h(d,t.title?t.title:r)),f.push(p(t,m,d,v,i));break;case"boolean":f.push(t.options&&"hidden"===t.options.inputRenderer?c(t,m,d,v,i):a(t,m,d,v,i));break;case"array":f.push(u(t,m,d,v,i));break;case"string":if(t.isEnum=void 0!==t["enum"],t.isHidden=t.options&&"hidden"===t.options.inputRenderer,t.isHidden&&(f=[]),(t.isEnum&&!t.isHidden||!t.isHidden)&&f.push(h(d,t.title?t.title:r,!t.isEnum&&t.minLength)),f.push(l(t,m,d,v,i)),t.isHidden)return n(f);break;default:throw new Error('Schema item "'+e.join(".")+'" is not valid')}return f.push("</div>"),n(f)}function r(e,t,i){var r=[],s=[],u=t.pop(),a=("root"+(t.length?"["+t.join("][")+"]":"")+"["+u+"]",(t.length?t.join("-")+"-":"")+u);return r.push('<label for="'+a+'">'+e.title+"</label>"),r.push('<select id="'+a+'" class="schema-property-oneOf-selector">'),t.push(u),$.each(e.oneOf,function(e,n){r.push('<option value="'+e+'">'+n.title+"</option>"),n.disabled=!0,s.push(o(n,t,i))}),r.push("</select>"),r.push("</div>"),r.push('<div class="schema-property schema-property-'+u+' schema-property-oneOf" style="display:none">'),r.push(n(s)),r.push("</div>"),f(function(){$(document).on("change",".schema-property-oneOf-selector",function(){var e=$(event.target);e.closest(".schema-property").siblings(".schema-property-oneOf").show().find("> fieldset").attr("disabled","disabled").hide().each(function(t){t===e[0].selectedIndex&&$(this).removeAttr("disabled").show()})})}),n(r)}function s(e,t,r){var s=[];return $.each(e,function(e,n){s.push(i(t,n,r))}),n(s)}function o(e,t,u){var a=[];return u=u||{},void 0===e.properties?e.allOf||e["extends"]?(a.push("<fieldset>"),a.push(s(e.allOf?e.allOf:e["extends"],t,u)),a.push("</fieldset>"),n(a)):e.oneOf?(a.push("<fieldset>"),a.push(r(e,t,u)),a.push("</fieldset>"),n(a)):e.$ref?this.getRef(e.$ref).then(function(e){return e.properties?o(e,t,u):i(t,e,u)}):n(a):(a.push("<fieldset"+(e.disabled?' disabled="disabled"':"")+">"),e.title&&a.push('<div class="legend">'+e.title+"</div>"),$.each(e.properties,function(e,n){t.slice(0),t.push(e),a.push(i(t,n,u[e]))}),a.push("</fieldset>"),n(a).then(function(t){if(e.required){var n=$("<p>").html(t);return $.each(e.required,function(e,t){n.find(["input","textarea","select"].map(function(e){return".schema-property-"+t+" > "+e}).join(",")).attr("required","required")}),n.html()}return t}))}function u(e,t,r,s,o){var u=[];return e.items["enum"]?(e.items.title=e.title,u.push(i(t,e.items,o).then(function(e){var t=$(e);return t.find("select").prop("multiple","multiple").each(function(){var e=$(this);e.attr("name",e.attr("name")+"[]").find("option").each(function(){var e=$(this);o&&-1!==o.indexOf(e.val())&&e.attr("selected","selected")})}),t.html()}))):(u.push("<fieldset>"),e.title&&u.push('<div class="legend">'+e.title+"</div>"),$.each(o||{},function(n,r){var s=t.slice(0);s.push(n),u.push(i(s,e.items,r))}),u.push("</fieldset>")),n(u)}function a(e,t,n,i,r){return'<input type="checkbox" name="'+i+'" id="'+n+'" value="1"'+(r?' checked="checked"':"")+' /><label for="'+n+'">'+e.title+"</label>"}function p(e,t,n,i,r){return"undefined"!=typeof e["enum"]?d(e,t,n,i,r):(e.format="number",c(e,t,n,i,r))}function l(e,t,n,i,r){return e.isEnum&&!e.isHidden?d(e,t,n,i,r):c(e,t,n,i,r)}function d(e,t,n,i,r){var s=[];void 0===r&&void 0!==e["default"]&&(r=e["default"]);var o=e.options&&e.options.enum_titles?e.options.enum_titles:{},u=e.options&&e.options.inputRenderer?e.options.inputRenderer:null;if(x(u))return j(u,e,t,n,i,r);var a=e.options&&e.options.multiple===!0,p=e.options&&e.options.readOnly===!0,l=e.options&&e.options.inputClasses?e.options.inputClasses.join(" "):!1,d=e.options&&e.options.rules?e.options.rules:!1;switch(e.inputType){case"radio":s.push('<div class="radiogroup">'),$.each(e["enum"],function(e,t){var u=n+"-"+t;s.push("<div>"),s.push('<input type="radio" name="'+i+'" value="'+t+'" id="'+u+'"'+(t===r?' checked="checked"':"")+'><label for="'+u+'">'+(o[e]||t)+"</label>"),s.push("</div>")}),s.push("</div>");break;default:s.push('<select name="'+i+'" id="'+n+'"'+(l?' class="'+l+'"':"")+(p?' readonly="readonly"':"")+(a?' multiple="multiple"':"")+(d?" data-rules='"+JSON.stringify(d)+"'":"")+">"),$.each(e["enum"],function(e,t){s.push('<option value="'+t+'"'+(t===r?' selected="selected"':"")+">"+(o[e]||t)+"</option>")}),s.push("</select>")}return s.join("")}function h(e,t,n){return'<label for="'+e+'">'+t+(n?" *":"")+"</label>"}function c(e,t,n,i,r){var s=e.format||"text";if(e.options&&e.options.inputRenderer&&(s=e.options.inputRenderer),x(s))return j(s,e,t,n,i,r);var o=e.description,u=e.options&&1==e.options.readOnly,a=e.options&&e.options.inputClasses?e.options.inputClasses.join(" "):!1,p=e.options&&e.options.rules?e.options.rules:!1;return"textarea"===s?'<textarea type="text"'+(a?' class="'+a+'"':"")+(n?' id="'+n+'"':"")+(i?' name="'+i+'"':"")+(e.minLength?' minlength="'+e.minLength+'"':"")+(e.maxLength?' maxlength="'+e.maxLength+'"':"")+(o?' placeholder="'+o+'"':"")+(u?' readonly="true"':"")+(p?" data-rules='"+JSON.stringify(p)+"'":"")+">"+(r||"")+"</textarea>":"<input "+(s?' type="'+s+'"':"")+(a?' class="'+a+'"':"")+(n?' id="'+n+'"':"")+(i?' name="'+i+'"':"")+(e.pattern?' pattern="'+e.pattern+'"':"")+(e.minLength?' minlength="'+e.minLength+'"':"")+(e.maxLength?' maxlength="'+e.maxLength+'"':"")+(e.min?' min="'+e.min+'"':"")+(e.max?' max="'+e.max+'"':"")+(r?' value="'+r+'"':"")+(e.title?' title="'+e.title+'"':"")+(o?' placeholder="'+o+'"':"")+(u?' readonly="true"':"")+(p?" data-rules='"+JSON.stringify(p)+"'":"")+"/>"}function f(e){O.push(e)}function m(){O.forEach(function(e){e()})}function v(e,t){k[e]=t}function y(e){return"undefined"!=typeof k[e]}function g(){var e=[].shift.call(arguments);return k[e]?k[e].apply(this,arguments):""}function b(e,t){R[e]=t}function x(e){return"undefined"!=typeof R[e]}function j(){var e=[].shift.call(arguments);return R[e]?R[e].apply(this,arguments):""}var O=[],k={},R={};return $.fn.appendSchema=function(e,t){var n=$(this);return o(e,[],t||{}).then(function(e){return n.append(e)})},{render:t,renderChunk:i,addRenderer:v,addInputRenderer:b}});